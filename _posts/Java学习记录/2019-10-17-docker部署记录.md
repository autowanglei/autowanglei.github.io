

# Docker部署

 ###  1.CentOS7下安装Docker-Compose


	https://www.cnblogs.com/YatHo/p/7815400.html 

```
yum -y install epel-release
yum install python-pip
pip install --upgrade pip
pip install docker-compose
```
###  2.centos7.5 下docker部署springboot应用 ###
	https://blog.csdn.net/u012371097/article/details/83622812
	docker build -t weighbridgecloudservice .
###    3.创建容器时[Warning] IPv4 forwarding is disabled. Networking will not work.
	https://blog.csdn.net/zhydream77/article/details/81902457
	在docker的宿主机中更改以下

```
[root@localhost ~]# vi /usr/lib/sysctl.d/00-system.conf

添加如下代码：
    net.ipv4.ip_forward=1

重启network服务
# systemctl restart network
```


###     4.docker常用指令
	docker rmi [image]


```
docker stop $(docker ps -a -q)  
//首先停掉所有的容器

docker rm $(docker ps -aq) 
//然后删除所有的容器

curl www.baidu.com

docker logs -f --tail -f/100 user-uat

docker run -d --net host weighbridgecloudservice
```
###  5.linux时间
​	date 查看当前时间
​	安装时间同步插件yum install ntpdate
​	开启时间同步service ntpdate restart
​	设置时区：
​	1）ntpdate time.nist.gov 与一个已知的时间服务器同步
​	rm -rf /etc/localtime 删除本地时间
​	ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime 设置时区为上海

### 6.docker镜像导出  导入

#### 6.1save load

##### 	save 示例

​		docker save -o nginx.tar nginx:latest
​		或
​		docker save > nginx.tar nginx:latest
​		其中-o和>表示输出到文件，nginx.tar为目标文件，nginx:latest是源镜像名（name:tag）

##### 	load 示例

​		docker load -i nginx.tar
​		或
​		docker load < nginx.tar
​		其中-i和<表示从文件输入。会成功导入镜像及相关元数据，包括tag信息

#### 6.2 export import 

##### export 示例

​	docker export -o nginx-test.tar nginx-test
​	其中-o表示输出到文件，nginx-test.tar为目标文件，nginx-test是源容器名（name）

##### import 示例

​	docker import nginx-test.tar nginx:imp
​	或
​	cat nginx-test.tar | docker import - nginx:imp

#### 6.3 区别

1. export命令导出的tar文件略小于save命令导出的
2. export命令是从容器（container）中导出tar文件，而save命令则是从镜像（images）中导出
3. 基于第二点，export导出的文件再import回去时，无法保留镜像所有历史（即每一层layer信息，不熟悉的可以去看Dockerfile），不能进行回滚操作；而save是依据镜像来的，所以导入时可以完整保留下每一层layer信息。如下图所示，nginx:latest是save导出load导入的，nginx:imp是export导出import导入的。