## 获取屏幕参数代码 ##

    DisplayMetrics displayMetrics = new DisplayMetrics();
    WindowManager mWm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    //android 4.2后增加了虚拟按键，API 17之后使用，获取的像素宽高包含虚拟键所占空间，在API 17之前通过反射获取
    if (Build.VERSION.SDK_INT >= 17) {
        mWm.getDefaultDisplay().getRealMetrics(displayMetrics);
        //获取的像素宽高不包含虚拟键所占空间
        //mWm.getDefaultDisplay().getRealMetrics(displayMetrics);
    } else {
        Display display = mWm.getDefaultDisplay();
        @SuppressWarnings("rawtypes")
        Class c;
        try {
            c = Class.forName("android.view.Display");
            @SuppressWarnings("unchecked")
            Method method = c.getMethod("getRealMetrics", DisplayMetrics.class);
            method.invoke(display, displayMetrics);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    int width = displayMetrics.widthPixels;  // 宽度（像素）  
    int height = displayMetrics.heightPixels;  // 高度（像素）  
    float density = displayMetrics.density;  // dp缩放因子  
    int densityDpi = displayMetrics.densityDpi;  // 广义密度  
    float xdpi = displayMetrics.xdpi;//x轴方向的真实密度  
    float ydpi = displayMetrics.ydpi;//y轴方向的真实密度  

getRealMetrics()和getMetrics()获取到的屏幕信息差别只在于widthPixels或heightPixels的值是否去除虚拟键所占用的像素，和是否全屏和沉浸模式无关。
 
屏幕高度值包含了状态栏的像素，非沉浸模式下真实的Activity高度需要减去状态栏的高度。获取状态栏高度代码：

    private int getStatusBarHeight() {  
        Rect rect = new Rect();  
        getWindow().getDecorView().getWindowVisibleDisplayFrame(rect);  
        return rect.top;  
    }  
 
屏幕参数Width和Height的值和屏幕方向有关，另外4个值和屏幕方向无关。


待续 详见http://xiaoyaozjl.iteye.com/blog/2178415